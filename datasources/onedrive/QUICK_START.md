# OneDrive快速上手指南

## 🚀 **5分钟快速配置**

### 第一步：配置OneDrive数据源节点

**在Dify界面中**：
1. 点击Pipeline画布的 "+" 按钮
2. 选择 "数据源" → "OneDrive"
3. 设置节点配置：
   ```
   节点名称: onedrive_docs
   操作模式: 下载文件
   文件ID: 4C588C50361D50A3!857
   ```

### 第二步：配置文档处理器节点

**添加文档处理器**：
1. 点击 "+" → "文档处理" → "文档加载器"
2. 设置节点配置：
   ```
   节点名称: doc_processor
   输入源: {{onedrive_docs.result}}
   分块大小: 1000
   重叠长度: 100
   文本提取: ✅ 启用
   ```

### 第三步：连接知识库

**添加知识库节点**：
1. 点击 "+" → "知识库" → "向量数据库"
2. 设置节点配置：
   ```
   节点名称: knowledge_base  
   文档源: {{doc_processor.documents}}
   嵌入模型: text-embedding-ada-002
   ```

## 📱 **实际操作界面**

### OneDrive节点界面
```
┌─────────────────────────────┐
│ 🔵 OneDrive数据源           │
├─────────────────────────────┤
│ 节点名称: onedrive_docs     │
│ 操作: [下载文件 ▼]         │
│ 文件ID: 4C588C50361D50A3!857│
│ [保存] [测试连接]           │
└─────────────────────────────┘
```

### 文档处理器界面
```
┌─────────────────────────────┐
│ 🔵 文档处理器               │
├─────────────────────────────┤
│ 节点名称: doc_processor     │
│ 输入: {{onedrive_docs.result}}│
│ 分块大小: [1000] 字符      │
│ 重叠: [100] 字符           │
│ ✅ 文本提取               │
│ [保存] [预览输出]          │
└─────────────────────────────┘
```

## ⚡ **下载文件的3种方式**

### 方式1：直接使用文件ID（推荐）
```yaml
# 您当前使用的方式
OneDrive节点配置:
  file_id: "4C588C50361D50A3!857"
  operation: "download_file"
```

### 方式2：通过文件浏览选择
```yaml
# 如果不知道文件ID
OneDrive节点配置:
  operation: "browse_files"
  folder_path: "root"
  # 然后从列表中选择文件
```

### 方式3：批量下载多个文件
```yaml
# 处理文件夹中的所有文件
OneDrive节点配置:
  operation: "browse_files" 
  folder_path: "Documents"
  # 配合循环节点处理每个文件
```

## 🔧 **关键配置参数**

### 文档处理器必备参数
| 参数 | 推荐值 | 说明 |
|------|--------|------|
| 分块大小 | 1000 | 适合大多数文档 |
| 重叠长度 | 100 | 保证内容连续性 |
| 文本提取 | 启用 | 必须启用才能处理 |
| 清理文本 | 启用 | 去除多余格式 |

### 支持的文件格式
- ✅ PDF文档
- ✅ Word文档 (.docx)  
- ✅ PowerPoint (.pptx)
- ✅ Excel文件 (.xlsx)
- ✅ 纯文本 (.txt)
- ✅ Markdown (.md)

## 🎯 **变量使用速查**

```javascript
// OneDrive节点输出
{{onedrive_docs.result}}                    // 完整文件内容
{{onedrive_docs.result.meta.file_name}}     // 文件名
{{onedrive_docs.result.meta.mime_type}}     // 文件类型

// 文档处理器输出  
{{doc_processor.documents}}                 // 处理后的文档块
{{doc_processor.documents[0].content}}      // 第一个文档块内容

// 知识库输出
{{knowledge_base.context}}                  // 搜索到的相关内容
```

## 🚨 **常见错误快速修复**

### 1. "文件ID不存在"错误
**解决方案**：
```
1. 检查文件ID是否正确复制
2. 确认文件未被删除或移动  
3. 验证OneDrive访问权限
```

### 2. "变量未定义"错误
**解决方案**：
```
1. 检查节点名称拼写
2. 确认节点已正确连接
3. 使用调试模式查看输出
```

### 3. "文档处理失败"错误
**解决方案**：
```
1. 确认文件格式受支持
2. 检查文件是否损坏
3. 调整分块大小参数
```

## ✅ **成功验证清单**

测试您的配置是否正确：

- [ ] OneDrive节点能成功下载文件
- [ ] 文档处理器能提取文本内容
- [ ] 知识库能接收处理后的文档
- [ ] 变量传递路径正确
- [ ] Pipeline能完整运行

**测试方法**：
1. 点击Pipeline的"运行"按钮
2. 查看每个节点的输出结果
3. 确认文档内容被正确处理

## 🎉 **完成后的效果**

配置完成后，您将能够：
- ✅ 自动从OneDrive下载指定文件
- ✅ 智能提取和分块文档内容
- ✅ 将文档存储到向量知识库
- ✅ 基于文档内容回答用户问题

现在您可以开始使用OneDrive文档来增强您的AI应用了！
