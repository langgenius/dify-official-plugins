# Dify 的 Notion 插件

## 概述

Dify 的 Notion 插件提供与 Notion 工作区的集成，允许您直接从 Dify 应用程序搜索、查询数据库、创建和更新页面。它使您能够在 Dify 环境中无缝地与 Notion 内容进行交互。

## 功能特性

- **搜索 Notion**：通过关键词在 Notion 工作区中搜索页面和数据库
- **查询数据库**：从特定的 Notion 数据库检索和筛选内容
- **创建页面**：在 Notion 工作区中创建带有自定义标题和内容的新页面
- **检索页面**：通过 ID 获取特定页面及其内容
- **更新页面**：更新现有页面的标题或添加新内容
- **检索数据库**：获取数据库结构和架构信息
- **创建数据库**：创建具有自定义属性和架构的新数据库
- **更新数据库**：修改现有数据库的标题或属性
- **检索评论**：从特定页面或块获取评论
- **创建评论**：向 Notion 页面添加新评论

## 配置

### 1. 在 Notion 中设置集成

访问 [Notion 集成](https://www.notion.so/my-integrations) 并创建一个新的**内部**集成或选择现有集成。

![](_assets/docs/integrations-creation.png)

为您的集成指定一个合适的名称，并选择要连接的工作区。

出于安全考虑，您可能希望限制集成的功能。例如，您可以通过仅启用"读取内容"权限来创建只读集成：

![](_assets/docs/integrations-capabilities.png)

从"Secrets"标签页复制您的"内部集成密钥"。您需要使用它在 Dify 中配置插件。

**重要提示：**请妥善保管此密钥。任何拥有此令牌的人都可以访问与您的集成共享的内容。

### 2. 将内容连接到您的集成

要让您的集成访问特定的页面或数据库，您必须明确地与集成共享它们：

1. 导航到您想通过插件访问的页面或数据库
2. 点击右上角的"•••"（三个点）菜单
3. 选择"添加连接"，然后从列表中选择您的集成

![](_assets/docs/connections.png)

对您想通过插件访问的每个页面或数据库重复此过程。

### 3. 在 Dify 中配置插件

1. 在您的 Dify 工作区中，导航到插件部分
2. 找到并选择 Notion 插件
3. 在配置字段中粘贴您的集成密钥
4. 保存您的配置

## 使用示例

### 搜索 Notion
```
在我的 Notion 工作区中查找包含"项目计划"的页面
```

### 查询数据库
```
显示 ID 为"abc123"的 Notion 数据库中状态为"进行中"的所有项目
```

### 创建页面
```
创建一个标题为"会议记录"的新 Notion 页面，内容为"讨论了项目时间表并分配了任务。"
```

### 检索页面
```
获取 ID 为"abc123"的 Notion 页面及其内容
```

### 更新页面
```
将 ID 为"abc123"的 Notion 页面标题更新为"更新的会议记录"，并添加内容"下周安排后续跟进"
```

### 检索数据库结构
```
获取 ID 为"abc123"的 Notion 数据库的结构和属性
```

### 创建数据库
```
在 ID 为"abc123"的 Notion 页面中创建一个标题为"项目任务"的新数据库，包含名称（标题）、状态（选择）和截止日期（日期）等属性
```

### 更新数据库
```
更新 ID 为"abc123"的 Notion 数据库，将"状态"属性重命名为"进度"
```

### 检索评论
```
获取 ID 为"abc123"的 Notion 页面的所有评论
```

### 创建评论
```
向 ID 为"abc123"的 Notion 页面添加评论"这项任务进展很好！"
```

## 支持的操作

1. **搜索**：在工作区中查找页面和数据库
2. **查询数据库**：从特定数据库检索和筛选记录
3. **创建页面**：创建带有标题和内容的新页面
4. **检索页面**：获取页面详细信息，包括属性和内容块
5. **更新页面**：修改页面标题或附加新内容
6. **检索数据库**：获取数据库结构、架构和属性类型
7. **创建数据库**：创建具有自定义属性的新数据库
8. **更新数据库**：更新数据库标题或修改属性
9. **检索评论**：从页面或块获取评论
10. **创建评论**：向页面添加评论
11. **提取数据**：处理各种 Notion 属性类型，包括富文本、选择、多选等

## 故障排除

- **身份验证错误**：确保您的集成令牌有效且未过期
- **访问错误**：确保集成已被授予对您尝试使用的页面/数据库的访问权限
- **未找到错误**：检查数据库或页面 ID 是否正确且可访问
- **速率限制**：如果收到速率限制错误，插件将自动使用退避策略重试
